<?xml version="1.0" encoding="UTF-8"?>
<CommandTranslatorRule priority="3" name="Specify ROI rule">This rule catches calls to the "Straighten..." command in Edit > Selection menu, that creates a new image by taking pixels along a line ROI.
	<Matcher class_name="ij.plugin.Straightener" arguments="" modifiers=".+" command="(&lt;command&gt;;.+)"></Matcher>
	<PythonTranslator>
# Straighten
width = 20 # how many pixels should we fetch from around the ROI?
# Get current ImagePlus
image = WindowManager.getCurrentImage()
if image is not None:
	roi = image.getRoi()
	if roi is not None and roi.isLine(): # we can only do it for line ROIs
		# Instantiate plugin
		straightener = Straightener()
		# Are we dealing with a stack?
		stack_size = image.getStackSize()
		if stack_size > 1:
			new_stack = straightener.straightenStack(image, roi, width)
			new_image = ImagePlus( image.getTitle()+"-straightened", new_stack)
		else:
			new_ip = straightener.straighten(image, roi, width)
			new_image = ImagePlus( image.getTitle()+"-straightened", new_ip)
		# Display result
		new_image.show()
	</PythonTranslator>
</CommandTranslatorRule>
